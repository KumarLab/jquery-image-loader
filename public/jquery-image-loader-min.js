(function(){var i,h,j;$.fn.loadImages=function(b){b=b?$.extend({},$.fn.loadImages.defaults,b):$.fn.loadImages.defaults;this.each(function(){var c=this,a=$(c),d;d=a.is("img[data-src]")?a:a.find("img[data-src]");d.length<1&&$.isFunction(b.noImgClb)?b.noImgClb.call(c):(a.data("dfd",$.Deferred()),a.data("options",b),a.data("total_images_count",d.length),a.data("processed_count",0),a.data("failed_count",0),$.when(i.call(c,d)).then(function(){$.isFunction(b.allLoadedClb)&&b.allLoadedClb.call(c)}))});return this};
i=function(b){var c=this,a=$(c).data("dfd");b.each(function(){var a=$(this);a.load(function(){h.call(c,a[0],"success")}).error(function(){h.call(c,a[0],"error")}).attr("src",a.data("src"))});return a.promise()};h=function(b,c){var a=$(this),d=a.data("dfd"),e=a.data("options"),f=a.data("processed_count")+1,g=a.data("total_images_count");a.data("processed_count",f);c==="success"&&$.isFunction(e.imgLoadedClb)&&e.imgLoadedClb.call(b,f,g);c==="error"&&(a.data("failed_count",a.data("failed_count")+1),$(this).unbind("load"),
$.isFunction(e.imgErrorClb)&&e.imgErrorClb.call(b,f,g));f===g&&(a.data("failed_count")===g?($.isFunction(e.noImgClb)&&e.noImgClb.call(this),d.reject()):d.resolve(),j.call(this))};j=function(){$(this).removeData("dfd","options","total_images_count","processed_count","failed_count")};$.fn.loadImages.defaults={imgLoadedClb:!1,allLoadedClb:!1,imgErrorClb:!1,noImgClb:!1}})(jQuery);
